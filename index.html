<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#667eea">
    <title>Kurdish Imposter - Party Word Game</title>
    
    <!-- PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Kurdish Imposter">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#667eea">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="manifest" href="manifest.json">
    <style>
        html {
            background: #667eea;
            height: 100vh;
            overflow: hidden;
        }
        
        body {
            box-sizing: border-box;
            margin: 0;
            padding: env(safe-area-inset-top) 0 0 0;
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            user-select: none;
            transition: all 0.3s ease;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Theme Backgrounds */
        .theme-dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .theme-light {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
        }

        .theme-modern {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .theme-modern::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            animation: modernBg 10s ease-in-out infinite alternate;
            z-index: 0;
        }

        @keyframes modernBg {
            0% { transform: scale(1) rotate(0deg); }
            100% { transform: scale(1.1) rotate(5deg); }
        }

        .floating-shapes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 60px;
            height: 60px;
            top: 60%;
            right: 10%;
            animation-delay: 2s;
        }

        .shape:nth-child(3) {
            width: 40px;
            height: 40px;
            top: 80%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .screen {
            display: none;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            z-index: 2;
        }

        .screen.scrollable {
            align-items: flex-start;
            overflow-y: auto;
            max-height: 100vh;
        }

        .screen.scrollable .container {
            margin: 20px auto;
        }

        .screen.active {
            display: flex;
        }

        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .btn {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff4757, #ff3838);
            color: white;
        }

        .input-group {
            margin: 15px 0;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .number-input-container {
            position: relative;
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 200px;
            margin: 0 auto;
            gap: 5px;
        }

        .number-input {
            width: 60px !important;
            padding: 12px !important;
            text-align: center;
            flex: 1;
        }

        .number-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .number-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #00f2fe, #4facfe);
        }

        .number-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .score-item .number-input-container {
            max-width: 120px;
            margin: 0;
        }
        
        .score-item .number-input {
            width: 50px !important;
            padding: 10px !important;
            font-size: 0.95rem;
            border-radius: 8px;
        }
        
        .score-item .number-btn {
            width: 32px;
            height: 32px;
            font-size: 1.1rem;
        }

        .players-list {
            max-height: 200px;
            overflow-y: auto;
            margin: 15px 0;
            width: 100%;
            padding-right: 10px;
        }

        .player-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            gap: 10px;
        }

        .player-number {
            width: 30px;
            height: 30px;
            background: #4facfe;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .player-name-input {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 8px;
        }

        .word-card {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            padding: 40px 20px;
            border-radius: 15px;
            margin: 20px 0;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .word-main {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .word-hint {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .imposter-card {
            background: linear-gradient(135deg, #fa709a, #fee140);
        }

        .game-info {
            font-size: 1.2rem;
            margin: 15px 0;
        }

        .history-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: left;
        }

        .history-date {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .word-editor {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
            max-height: 70vh;
            overflow-y: auto;
        }

        .word-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }

        .word-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(0,0,0,0.1);
            border-radius: 8px;
            margin: 8px 0;
        }

        .delete-btn {
            background: #fa709a;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        /* Theme Selector */
        .theme-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }

        .theme-btn {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn.active {
            border-color: white;
            transform: scale(1.1);
        }

        .theme-dark-btn { background: linear-gradient(135deg, #1a1a2e, #16213e); }
        .theme-light-btn { background: linear-gradient(135deg, #f5f7fa, #c3cfe2); }
        .theme-modern-btn { background: linear-gradient(135deg, #667eea, #764ba2); }

        /* Score Section */
        .score-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .score-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .score-item .number-input {
            width: 50px !important;
            padding: 10px !important;
            font-size: 0.95rem;
            border-radius: 8px;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Splash Screen */
        .splash-logo {
            width: 200px;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            margin: 0 auto 30px;
            border: 3px solid rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            background-image: url('splash.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .splash-logo.no-image {
            background-image: none;
        }

        .splash-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            text-align: center;
        }

        .splash-subtitle {
            font-size: 1.2rem;
            color: rgba(255,255,255,0.9);
            margin-bottom: 40px;
            text-align: center;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Game Icon Animation */
        .game-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px auto;
            position: relative;
            animation: bounce 2s ease-in-out infinite;
        }

        .game-icon::before {
            content: '🎭';
            font-size: 60px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: rotate 3s linear infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes rotate {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Tap Animation Effects */
        .tap-effect {
            position: relative;
            overflow: hidden;
        }

        .tap-ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        .tap-bounce {
            animation: tapBounce 0.3s ease-out;
        }

        @keyframes tapBounce {
            0% { transform: scale(1); }
            50% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 10px;
                width: calc(100% - 20px);
                max-width: none;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .word-main {
                font-size: 1.5rem;
            }

            .screen {
                padding: 10px;
            }

            .back-btn {
                top: 10px;
                left: 10px;
            }
        }

        /* Disable tap highlight and selection */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        /* Winner highlight for results */
        .winner {
            color: #43e97b;
            font-weight: bold;
            font-size: 1.1em;
        }
        .imposter-red {
            color: #ff3838 !important;
        }
        /* News Ticker Styles */
        .news-ticker {
            position: sticky;
            top: 0;
            z-index: 3;
            display: flex;
            align-items: center;
            height: 52px;
            background: rgba(0,0,0,0.15);
            backdrop-filter: blur(6px);
            padding: 0 14px;
            box-sizing: border-box;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            overflow: hidden;
            direction: ltr; /* container default; individual messages set dir="rtl" when needed */
        }

        .news-ticker .label {
            font-weight: 700;
            margin-right: 12px;
            white-space: nowrap;
            flex: 0 0 auto;
            font-size: 0.95rem;
            padding-right: 10px;
            border-right: 1px solid rgba(255,255,255,0.04);
        }

        .news-ticker .ticker-track {
            position: relative;
            flex: 1 1 auto;
            overflow: hidden;
            height: 100%;
            display: flex;
            align-items: center;
            gap: 40px;
        }

        .ticker-item {
            white-space: nowrap;
            display: inline-block;
            font-size: 1rem;
            will-change: transform;
            color: inherit;
        }

        /* Single-item sequential ticker (used by JS) */
        .ticker-track { position: relative; overflow: hidden; }
        .ticker-single {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center; /* vertically center the text */
            padding-left: 8px;
            white-space: nowrap;
            font-size: 1rem;
            will-change: transform;
            color: inherit;
        }

        @keyframes move-ltr {
            from { transform: translateX(-120%); }
            to   { transform: translateX(120%); }
        }

        @keyframes move-rtl {
            from { transform: translateX(120%); }
            to   { transform: translateX(-120%); }
        }

        .ticker-item.animate-ltr { animation-name: move-ltr; animation-timing-function: linear; animation-iteration-count: infinite; animation-fill-mode: forwards; }
        .ticker-item.animate-rtl { animation-name: move-rtl; animation-timing-function: linear; animation-iteration-count: infinite; animation-fill-mode: forwards; }

        /* Pause on hover / touch */
        .news-ticker:hover .ticker-item,
        .news-ticker.touching .ticker-item { animation-play-state: paused; }

        @media (max-width: 480px) {
            .news-ticker { height: 46px; padding: 0 10px; }
            .ticker-item { font-size: 0.95rem; }
            .news-ticker .label { display: none; }
        }
    </style>
</head>
<body class="theme-modern">
    <!-- News Ticker (editable) -->
    <div class="news-ticker" role="region" aria-label="News ticker" aria-live="polite">
        <div class="label">زانیاری</div>
        <div class="ticker-track" aria-hidden="true">
            <!-- JS will populate messages here. Edit window.tickerMessages in the script below to change texts. -->
        </div>
    </div>
    <!-- Floating Shapes for Modern Theme -->
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>
    <!-- Splash Screen -->
    <div class="screen active" id="splashScreen">
        <div class="splash-logo" id="splashLogo">🎭</div>
        <h1 class="splash-title">Kurdish Imposter</h1>
        <p class="splash-subtitle">Party Word Game</p>
        <div class="loading"></div>
    </div>

    <!-- Main Menu -->
    <div class="screen" id="mainMenu">
        <div class="container">
            <div class="game-icon"></div>
            <h1 class="title">Kurdish Imposter</h1>
            <button class="btn btn-primary" onclick="showGameSetup()">Start Game</button>
            <button class="btn btn-secondary" onclick="showSettings()">Settings</button>
            <button class="btn" onclick="showHistory()">Game History</button>
            <!-- Updates Button -->
            <button class="btn" onclick="showUpdates()" id="updatesBtn">Updates</button>
        </div>
    </div>

    <!-- Game Setup -->
    <div class="screen" id="gameSetup">
        <button class="back-btn" onclick="showMainMenu()">← Back</button>
        <div class="container">
            <h2 class="title">Game Setup</h2>
            
            <div class="input-group">
                <label>Number of Players:</label>
                <div class="number-input-container">
                    <button class="number-btn decrease" onclick="adjustNumber('playerCount', -1)">-</button>
                    <input type="number" id="playerCount" class="number-input" min="3" max="20" value="5" onchange="updatePlayersList()">
                    <button class="number-btn increase" onclick="adjustNumber('playerCount', 1)">+</button>
                </div>
            </div>
            
            <div class="input-group">
                <label>Number of Imposters:</label>
                <div class="number-input-container">
                    <button class="number-btn decrease" onclick="adjustNumber('imposterCount', -1)">-</button>
                    <input type="number" id="imposterCount" class="number-input" min="1" max="5" value="1">
                    <button class="number-btn increase" onclick="adjustNumber('imposterCount', 1)">+</button>
                </div>
            </div>

            <div class="input-group">
                <label>Player Names:</label>
                <div class="players-list" id="playersList"></div>
            </div>


            
            <button class="btn btn-primary" onclick="startGame()">Start Game</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div class="screen" id="gameScreen">
        <div class="container">
            <div class="game-info">
                <span id="currentPlayerName">Player 1</span> (<span id="currentPlayerNum">1</span> / <span id="totalPlayers">5</span>)
            </div>
            
            <div class="word-card" id="wordCard">
                <div class="word-main" id="wordMain">Tap to reveal</div>
                <div class="word-hint" id="wordHint">Your role</div>
            </div>
            
            <button class="btn btn-primary" onclick="revealWord()" id="revealBtn">Tap to See Your Role</button>
            
            <div id="gameNavigation" style="display: none;">
                <button class="btn btn-secondary" onclick="nextPlayer()" id="nextBtn">Next Player</button>
            </div>

            <!-- Score Section -->
            <div class="score-section" id="scoreSection" style="display: none;">
                <h3 style="text-align: center; margin-bottom: 15px;">Enter Player Scores</h3>
                <div class="score-inputs" id="scoreInputs"></div>
                <div style="text-align: center; margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="nextRound()" style="flex: 1;">Next Round</button>
                    <button class="btn btn-danger" onclick="endGame()" style="flex: 1;">End Game</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings -->
    <div class="screen scrollable" id="settingsScreen">
        <button class="back-btn" onclick="showMainMenu()">← Back</button>
        <div class="container">
            <h2 class="title">Settings</h2>
            
            <div class="input-group">
                <label>Language:</label>
                <select id="languageSelect" onchange="changeLanguage(this.value)">
                    <option value="en">English</option>
                    <option value="ku">Kurdish-Sorani</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>Theme:</label>
                <div class="theme-selector">
                    <div class="theme-btn theme-dark-btn" onclick="changeTheme('dark')" title="Dark Theme"></div>
                    <div class="theme-btn theme-light-btn" onclick="changeTheme('light')" title="Light Theme"></div>
                    <div class="theme-btn theme-modern-btn active" onclick="changeTheme('modern')" title="Modern Theme"></div>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="toggleWordEditor()">Edit Words</button>
            <button class="btn btn-secondary" onclick="openMoreGames()">More Games</button>
            <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
            <button class="btn btn-secondary" onclick="showAbout()">About</button>
            
            <div class="word-editor" id="wordEditor">
                <h3>Word Database</h3>
                
                <div class="input-group">
                    <label>English Word:</label>
                    <input type="text" id="newWordEn" placeholder="Enter English word">
                </div>
                
                <div class="input-group">
                    <label>Kurdish Word:</label>
                    <input type="text" id="newWordKu" placeholder="وشەی کوردی بنووسە">
                </div>
                
                <div class="input-group">
                    <label>English Hint:</label>
                    <input type="text" id="newHintEn" placeholder="Enter English hint">
                </div>
                
                <div class="input-group">
                    <label>Kurdish Hint:</label>
                    <input type="text" id="newHintKu" placeholder="ئاماژەی کوردی بنووسە">
                </div>
                
                <button class="btn btn-primary" onclick="addNewWord()">Add Word</button>
                
                <div class="word-list" id="wordList"></div>
            </div>
        </div>
    </div>

    <!-- Game History -->
    <div class="screen" id="historyScreen">
        <button class="back-btn" onclick="showMainMenu()">← Back</button>
        <div class="container">
            <h2 class="title">Game History</h2>
            <div id="historyList"></div>
        </div>
    </div>

    <!-- Updates Page -->
    <div class="screen scrollable" id="updatesScreen">
        <button class="back-btn" onclick="showMainMenu()">← گەڕانەوە</button>
        <div class="container">
            <h2 class="title" id="updatesTitle">نوێکاریەکان</h2>
            <!--
                Edit the content below to update the "What's New" section.
                You can add HTML, lists, etc.
            -->
            <div id="updatesContent">
                <h2>_____________________</h2>
                <h2>وەشانی 1,0,8</h2>
                <h3>زیادکراوەکان</h3>
                <ul>
                    <li>زیادکردنی شریتی هەواڵ و زانیاریەکان بۆ بەشی سەرەوەی پەڕەی سەرەکی</li>
                    <li>زیادکردی تایبەتماندی ئیشکردی یاریەکە بە بێ خەت ( ئۆفڵاین ) پاش دابەزاندن و ئیشپێکردنی یاریەکە بۆ یەکەمین جار</li>
                </ul>
                <h3>گۆڕانکاریەکان</h3>
                <ul>
                    <li>کەمتر دووبارە بوونەوەی وشەکان</li>
                </ul>
                <h2>وەشانی 1,0,7</h2>
                <h3>زیادکراوەکان</h3>
                <ul>
                    <li>زیادکردنی پەڕەیەکی نوێ بۆ کاتی کۆتایی هێنان بە یاریەکە کە تێیدا خاڵەکان نیشان دەدرێت و براوە دەستنیشان دەکرێت</li>
                    <li>پەڕەیەکی نوێ "نوێکارییەکان" زیادکرا بۆ زانیاری دەربارەی گۆڕانکارییە نوێکان</li>
                </ul>
                <h3>گۆڕانکاریەکان</h3>
                <ul>
                    <li>ئێستا لەجیاتی بۆکسی پڕتەقاڵی بۆ ساختەکار تەنها ناونیشانی ساختەکارەکە سور دەبێت بەمەبەستی نەهێشتنی تیشکدانەوە لەسەر دەموچاو لە کاتی یاریکردندا</li>
                    <li>وەشانی یاری لە پەڕەی دەربارە سڕایەوە بەهۆی ئەوەی لە پەڕەی "نوێکاریەکان"دا بەردەستە</li>
                    <li>چاککردنی هەندێک لە ووشە کوردییەکان</li>
                </ul>
                <h2>وەشانە کۆنەکان</h2>
                <ul>
                    <li>گۆڕانکاریە کۆنەکان بەردەست نین.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Game Results Modal/Screen -->
    <div class="screen" id="resultsScreen" style="background: rgba(0,0,0,0.8);">
        <div class="container" style="max-width: 400px;">
            <h3 style="margin-bottom: 20px;">ئەنجامی یاریەکە</h3>
            <div id="resultsList"></div>
            <button class="btn btn-primary" onclick="returnToHome()">گەڕانەوە بۆ پەڕەی سەرەکی</button>
        </div>
    </div>

    <!-- About -->
    <div class="screen" id="aboutScreen">
        <button class="back-btn" onclick="showSettings()">← Back</button>
        <div class="container">
            <h2 class="title">About</h2>
            <p><strong>Kurdish Imposter</strong></p>
            <p>Developer: Didar Baxtear</p>
            <p>An exciting party word game where players try to identify the imposters among them!</p>
        </div>
    </div>

    <!-- Custom Word Dialog for Next Round -->
    <div class="screen" id="customWordDialog" style="background: rgba(0,0,0,0.8);">
        <div class="container" style="max-width: 400px;">
            <h3 style="margin-bottom: 20px;">Round 2 - Choose Word</h3>
            <p style="margin-bottom: 20px;">Would you like to use a custom word for the next round?</p>
            
            <div class="input-group">
                <label>Custom Word:</label>
                <input type="text" id="dialogCustomWord" placeholder="Enter custom word" style="width: 100%; padding: 12px; border: none; border-radius: 10px; box-sizing: border-box;">
            </div>
            
            <div class="input-group">
                <label>Hint:</label>
                <input type="text" id="dialogCustomHint" placeholder="Enter hint for the word" style="width: 100%; padding: 12px; border: none; border-radius: 10px; box-sizing: border-box;">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-primary" onclick="useCustomWordNextRound()" style="flex: 1;">Use Custom Word</button>
                <button class="btn btn-secondary" onclick="useRandomWordNextRound()" style="flex: 1;">Use Random Word</button>
            </div>
        </div>
    </div>

    <!-- Custom Confirmation Dialog -->
    <div class="screen" id="confirmDialog" style="background: rgba(0,0,0,0.8);">
        <div class="container" style="max-width: 350px;">
            <h3 style="margin-bottom: 20px;">⚠️ Clear All Data</h3>
            <p style="margin-bottom: 30px;">Are you sure you want to clear all game history and settings? This cannot be undone!</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-danger" onclick="confirmClearData()" style="flex: 1;">Yes, Clear All</button>
                <button class="btn" onclick="cancelClearData()" style="flex: 1;">Cancel</button>
            </div>
        </div>
    </div>

    <script src="wordDatabase.js"></script>
    <script>
        // Game state
        let gameState = {
            players: 5,
            imposters: 1,
            currentPlayer: 1,
            playerNames: [],
            playerRoles: [],
            wordRevealed: false,
            playerScores: [],
            roundNumber: 1
        };

        // Theme system
        let currentTheme = 'modern';
        
        // Language system
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                // Main Menu
                startGame: "Start Game",
                settings: "Settings",
                gameHistory: "Game History",
                updates: "Updates",
                
                // Game Setup
                gameSetup: "Game Setup",
                numberOfPlayers: "Number of Players:",
                numberOfImposters: "Number of Imposters:",
                playerNames: "Player Names:",
                back: "← Back",
                
                // Game Screen
                tapToReveal: "Tap to reveal",
                yourRole: "Your role",
                tapToSeeRole: "Tap to See Your Role",
                nextPlayer: "Next Player",
                startDiscussion: "Start Discussion",
                discussionTime: "Discussion Time!",
                findImposters: "Find the imposters!",
                enterScores: "Enter Player Scores",
                nextRound: "Next Round",
                endGame: "End Game",
                youAreImposter: "You are the IMPOSTER!",
                noHints: "No hints for you!",
                hint: "Hint:",
                round: "Round",
                total: "Total:",
                points: "points",
                roundScore: "Round score",
                
                // Settings
                language: "Language:",
                theme: "Theme:",
                editWords: "Edit Words",
                moreGames: "More Games",
                clearAllData: "Clear All Data",
                about: "About",
                
                // Word Editor
                wordDatabase: "Word Database",
                englishWord: "English Word:",
                kurdishWord: "Kurdish Word:",
                englishHint: "English Hint:",
                kurdishHint: "Kurdish Hint:",
                addWord: "Add Word",
                delete: "Delete",
                enterEnglishWord: "Enter English word",
                enterKurdishWord: "وشەی کوردی بنووسە",
                enterEnglishHint: "Enter English hint",
                enterKurdishHint: "ئاماژەی کوردی بنووسە",
                
                // History
                noGamesYet: "No games played yet",
                gameSession: "Game Session:",
                rounds: "rounds",
                round_single: "round",
                finalScores: "Final Scores:",
                impostersPerRound: "Imposters per round:",
                
                // About
                version: "Version: 1.0",
                developer: "Developer: Didar Baxtear",
                description: "An exciting party word game where players try to identify the imposters among them!",
                
                // Confirmation Dialog
                clearAllDataTitle: "⚠️ Clear All Data",
                clearAllDataMessage: "Are you sure you want to clear all game history and settings? This cannot be undone!",
                yesClearAll: "Yes, Clear All",
                cancel: "Cancel",
                
                // Alerts and Messages
                impostersLessThanPlayers: "Imposters must be less than total players!",
                revealRoleFirst: "Please reveal your role first!",
                fillAllFields: "Please fill all fields!",
                cannotDelete: "Cannot delete! Minimum 5 words required.",
                deleteWord: "Delete this word?",
                allDataCleared: "✅ All data cleared successfully!",
                
                // Player placeholders
                player: "Player",
                
                // Custom Word Feature
                useCustomWord: "Use Custom Word for This Round",
                customWordTitle: "Choose Word",
                customWordPrompt: "Would you like to use a custom word for the next round?",
                customWordLabel: "Custom Word:",
                customHintLabel: "Hint:",
                useCustomWordBtn: "Use Custom Word",
                useRandomWordBtn: "Use Random Word",
                enterCustomWord: "Enter custom word",
                enterCustomHint: "Enter hint for the word"
            },
            ku: {
                // Main Menu
                startGame: "یاری نوێ",
                settings: "ڕێکخستنەکان",
                gameHistory: "مێژووی یاریە کۆنەکان",
                updates: "نوێکارییەکان",
                
                // Game Setup
                gameSetup: "ڕێکخستنی یاری",
                numberOfPlayers: "ژمارەی یاریزانان:",
                numberOfImposters: "ژمارەی ساختەکاران:",
                playerNames: "ناوی یاریزانان:",
                back: "← گەڕانەوە",
                
                // Game Screen
                tapToReveal: "ئاشکراکردن",
                yourRole: "ڕۆڵەکەت",
                tapToSeeRole: "دەستی پێدانێ بۆ بینینی ڕۆڵەکەت",
                nextPlayer: "یاریزانی داهاتوو",
                startDiscussion: "گفتوگۆ دەستپێبکە",
                discussionTime: "کاتی دۆزینەوەی ساختەکار",
                findImposters: "ساختەکار بدۆزنەوە",
                enterScores: "خاڵەکان بنووسە",
                nextRound: "گەڕی داهاتوو",
                endGame: "کۆتایی هێنان بە یاری",
                youAreImposter: "تۆ ساختەکاریت",
                noHints: "هیچ ئاماژەیەکت نییە!",
                hint: "ئاماژە:",
                round: "گەڕ",
                total: "کۆی گشتی:",
                points: "خاڵ",
                roundScore: "خاڵی گەڕ",
                
                // Settings
                language: "زمان:",
                theme: "ڕووکار:",
                editWords: "وشەکان دەستکاری بکە",
                moreGames: "یارییەکانی ترم",
                clearAllData: "هەموو زانیاریەکان بسڕەوە",
                about: "دەربارە",
                
                // Word Editor
                wordDatabase: "بنکەی زانیاری وشەکان",
                englishWord: "وشەی ئینگلیزی:",
                kurdishWord: "وشەی کوردی:",
                englishHint: "ئاماژەی ئینگلیزی:",
                kurdishHint: "ئاماژەی کوردی:",
                addWord: "وشە زیاد بکە",
                delete: "سڕینەوە",
                enterEnglishWord: "Enter English word",
                enterKurdishWord: "وشەی کوردی بنووسە",
                enterEnglishHint: "Enter English hint",
                enterKurdishHint: "ئاماژەی کوردی بنووسە",
                
                // History
                noGamesYet: "هێشتا هیچ یارییەک نەکراوە",
                gameSession: "دانیشتنی یاری:",
                rounds: "گەڕ",
                round_single: "گەڕ",
                finalScores: "خاڵە کۆتاییەکان:",
                impostersPerRound: "ساختەکار بۆ هەر گەڕێک:",
                
                // About
                version: "وەشان: ١.٠",
                developer: "گەشەپێدەر: دیدار بەختیار",
                description: "یارییەکی سەرنجڕاکێشی کۆمەڵایەتی کە یاریزانان هەوڵ دەدەن ساختەکاران لەنێو خۆیاندا بناسنەوە!",
                
                // Confirmation Dialog
                clearAllDataTitle: "⚠️ هەموو زانیاریەکان بسڕەوە",
                clearAllDataMessage: "دڵنیایت کە دەتەوێت هەموو مێژووی یاری و ڕێکخستنەکان بسڕیتەوە؟ ئەمە ناگەڕێتەوە!",
                yesClearAll: "بەڵێ، هەمووی بسڕەوە",
                cancel: "پەشیمانبوونەوە",
                
                // Alerts and Messages
                impostersLessThanPlayers: "ساختەکاران دەبێت کەمتر بن لە کۆی یاریزانان!",
                revealRoleFirst: "تکایە سەرەتا ڕۆڵەکەت ئاشکرا بکە!",
                fillAllFields: "تکایە هەموو خانەکان پڕ بکەرەوە!",
                cannotDelete: "ناتوانرێت بسڕدرێتەوە! لانیکەم ٥ وشە پێویستە.",
                deleteWord: "ئەم وشەیە بسڕیتەوە؟",
                allDataCleared: "✅ هەموو زانیاریەکان بە سەرکەوتوویی سڕانەوە!",
                
                // Player placeholders
                player: "یاریزان",
                
                // Custom Word Feature
                useCustomWord: "وشەی تایبەت بۆ ئەم گەڕە بەکاربهێنە",
                customWordTitle: "وشە هەڵبژێرە",
                customWordPrompt: "دەتەوێت وشەی تایبەت بۆ گەڕی داهاتوو بەکاربهێنیت؟",
                customWordLabel: "وشەی تایبەت:",
                customHintLabel: "ئاماژە:",
                useCustomWordBtn: "وشەی تایبەت بەکاربهێنە",
                useRandomWordBtn: "وشەی هەڕەمەکی بەکاربهێنە",
                enterCustomWord: "وشەی تایبەت بنووسە",
                enterCustomHint: "ئاماژە بۆ وشەکە بنووسە"
            }
        };

        function changeTheme(theme) {
            currentTheme = theme;
            document.body.className = `theme-${theme}`;
            
            // Update active theme button
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.theme-${theme}-btn`).classList.add('active');
            
            localStorage.setItem('kurdishImposterTheme', theme);
        }

        function changeLanguage(language) {
            currentLanguage = language;
            localStorage.setItem('kurdishImposterLanguage', language);
            updateLanguageDisplay();
        }

        function updateLanguageDisplay() {
            const t = translations[currentLanguage];
            
            // Update main menu
            const mainMenuButtons = document.querySelectorAll('#mainMenu .btn');
            if (mainMenuButtons[0]) mainMenuButtons[0].textContent = t.startGame;
            if (mainMenuButtons[1]) mainMenuButtons[1].textContent = t.settings;
            if (mainMenuButtons[2]) mainMenuButtons[2].textContent = t.gameHistory;
            if (mainMenuButtons[3]) mainMenuButtons[3].textContent = t.updates; // <-- Add this line

            // Update game setup
            const gameSetupTitle = document.querySelector('#gameSetup .title');
            if (gameSetupTitle) gameSetupTitle.textContent = t.gameSetup;
            
            const gameSetupLabels = document.querySelectorAll('#gameSetup label');
            if (gameSetupLabels[0]) gameSetupLabels[0].textContent = t.numberOfPlayers;
            if (gameSetupLabels[1]) gameSetupLabels[1].textContent = t.numberOfImposters;
            if (gameSetupLabels[2]) gameSetupLabels[2].textContent = t.playerNames;
            
            const gameSetupBtn = document.querySelector('#gameSetup .btn-primary');
            if (gameSetupBtn) gameSetupBtn.textContent = t.startGame;
            
            const gameSetupBackBtn = document.querySelector('#gameSetup .back-btn');
            if (gameSetupBackBtn) gameSetupBackBtn.textContent = t.back;
            
            // Update game screen elements
            const revealBtn = document.getElementById('revealBtn');
            if (revealBtn) revealBtn.textContent = t.tapToSeeRole;
            
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn && nextBtn.textContent === 'Next Player') nextBtn.textContent = t.nextPlayer;
            if (nextBtn && nextBtn.textContent === 'Start Discussion') nextBtn.textContent = t.startDiscussion;
            
            // Update settings
            const settingsTitle = document.querySelector('#settingsScreen .title');
            if (settingsTitle) settingsTitle.textContent = t.settings;
            
            const settingsLabels = document.querySelectorAll('#settingsScreen label');
            if (settingsLabels[0]) settingsLabels[0].textContent = t.language;
            if (settingsLabels[1]) settingsLabels[1].textContent = t.theme;
            
            const settingsButtons = document.querySelectorAll('#settingsScreen .btn');
            if (settingsButtons[0]) settingsButtons[0].textContent = t.editWords;
            if (settingsButtons[1]) settingsButtons[1].textContent = t.moreGames;
            if (settingsButtons[2]) settingsButtons[2].textContent = t.clearAllData;
            if (settingsButtons[3]) settingsButtons[3].textContent = t.about;
            
            const settingsBackBtn = document.querySelector('#settingsScreen .back-btn');
            if (settingsBackBtn) settingsBackBtn.textContent = t.back;
            
            // Update word editor
            const wordEditorTitle = document.querySelector('#wordEditor h3');
            if (wordEditorTitle) wordEditorTitle.textContent = t.wordDatabase;
            
            const wordEditorLabels = document.querySelectorAll('#wordEditor label');
            if (wordEditorLabels[0]) wordEditorLabels[0].textContent = t.englishWord;
            if (wordEditorLabels[1]) wordEditorLabels[1].textContent = t.kurdishWord;
            if (wordEditorLabels[2]) wordEditorLabels[2].textContent = t.englishHint;
            if (wordEditorLabels[3]) wordEditorLabels[3].textContent = t.kurdishHint;
            
            const addWordBtn = document.querySelector('#wordEditor .btn-primary');
            if (addWordBtn) addWordBtn.textContent = t.addWord;
            
            // Update placeholders
            const newWordEn = document.getElementById('newWordEn');
            if (newWordEn) newWordEn.placeholder = t.enterEnglishWord;
            
            const newWordKu = document.getElementById('newWordKu');
            if (newWordKu) newWordKu.placeholder = t.enterKurdishWord;
            
            const newHintEn = document.getElementById('newHintEn');
            if (newHintEn) newHintEn.placeholder = t.enterEnglishHint;
            
            const newHintKu = document.getElementById('newHintKu');
            if (newHintKu) newHintKu.placeholder = t.enterKurdishHint;
            
            // Update history title
            const historyTitle = document.querySelector('#historyScreen .title');
            if (historyTitle) historyTitle.textContent = t.gameHistory;
            
            const historyBackBtn = document.querySelector('#historyScreen .back-btn');
            if (historyBackBtn) historyBackBtn.textContent = t.back;
            
            // Update about screen
            const aboutTitle = document.querySelector('#aboutScreen .title');
            if (aboutTitle) aboutTitle.textContent = t.about;
            
            const aboutBackBtn = document.querySelector('#aboutScreen .back-btn');
            if (aboutBackBtn) aboutBackBtn.textContent = t.back;
            
            const aboutContent = document.querySelectorAll('#aboutScreen p');
            if (aboutContent[1]) aboutContent[1].textContent = t.developer;
            if (aboutContent[2]) aboutContent[2].textContent = t.description;
            
            // Update confirmation dialog
            const confirmTitle = document.querySelector('#confirmDialog h3');
            if (confirmTitle) confirmTitle.textContent = t.clearAllDataTitle;
            
            const confirmMessage = document.querySelector('#confirmDialog p');
            if (confirmMessage) confirmMessage.textContent = t.clearAllDataMessage;
            
            const confirmButtons = document.querySelectorAll('#confirmDialog .btn');
            if (confirmButtons[0]) confirmButtons[0].textContent = t.yesClearAll;
            if (confirmButtons[1]) confirmButtons[1].textContent = t.cancel;
            

            
            // Update custom word dialog
            const dialogCustomWordInput = document.getElementById('dialogCustomWord');
            if (dialogCustomWordInput) dialogCustomWordInput.placeholder = t.enterCustomWord;
            
            const dialogCustomHintInput = document.getElementById('dialogCustomHint');
            if (dialogCustomHintInput) dialogCustomHintInput.placeholder = t.enterCustomHint;
            
            const dialogLabels = document.querySelectorAll('#customWordDialog label');
            if (dialogLabels[0]) dialogLabels[0].textContent = t.customWordLabel;
            if (dialogLabels[1]) dialogLabels[1].textContent = t.customHintLabel;
            
            const dialogButtons = document.querySelectorAll('#customWordDialog .btn');
            if (dialogButtons[0]) dialogButtons[0].textContent = t.useCustomWordBtn;
            if (dialogButtons[1]) dialogButtons[1].textContent = t.useRandomWordBtn;
            
            const dialogPrompt = document.querySelector('#customWordDialog p');
            if (dialogPrompt) dialogPrompt.textContent = t.customWordPrompt;
        }

        // Screen navigation functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showMainMenu() {
            showScreen('mainMenu');
        }

        function showGameSetup() {
            showScreen('gameSetup');
            updatePlayersList();
        }

        function showSettings() {
            showScreen('settingsScreen');
            updateWordList();
        }

        function showHistory() {
            showScreen('historyScreen');
            loadGameHistory();
        }

        function showAbout() {
            showScreen('aboutScreen');
        }

        // Show Updates screen
        function showUpdates() {
            showScreen('updatesScreen');
        }

        // Show Results screen
        function showResultsScreen() {
            // Calculate total scores and winner(s)
            const t = translations[currentLanguage];
            const scores = gameState.playerScores.map(arr => arr.reduce((a, b) => a + b, 0));
            const maxScore = Math.max(...scores);
            const winners = [];
            for (let i = 0; i < scores.length; i++) {
                if (scores[i] === maxScore) winners.push(gameState.playerNames[i]);
            }
            let html = '<ul style="list-style:none;padding:0;">';
            for (let i = 0; i < gameState.players; i++) {
                const isWinner = scores[i] === maxScore;
                html += `<li${isWinner ? ' class="winner"' : ''}>${gameState.playerNames[i]}: ${scores[i]} ${t.points}${isWinner ? ' 🏆' : ''}</li>`;
            }
            html += '</ul>';
            html += `<div style="margin-top:25px;"><strong>براوە${winners.length > 1 ? 'کان' : ''}:</strong> ${winners.join(', ')}</div>`;
            document.getElementById('resultsList').innerHTML = html;
            showScreen('resultsScreen');
        }

        function returnToHome() {
            showMainMenu();
        }

        // Player management
        function updatePlayersList() {
            const t = translations[currentLanguage];
            const count = parseInt(document.getElementById('playerCount').value);
            const container = document.getElementById('playersList');
            container.innerHTML = '';
            
            for (let i = 1; i <= count; i++) {
                const playerItem = document.createElement('div');
                playerItem.className = 'player-item';
                playerItem.innerHTML = `
                    <div class="player-number">${i}</div>
                    <input type="text" class="player-name-input" placeholder="${t.player} ${i}" value="${gameState.playerNames[i-1] || ''}" onchange="updatePlayerName(${i-1}, this.value)">
                `;
                container.appendChild(playerItem);
            }
        }

        function updatePlayerName(index, name) {
            const t = translations[currentLanguage];
            if (!gameState.playerNames) gameState.playerNames = [];
            gameState.playerNames[index] = name || `${t.player} ${index + 1}`;
        }

        // Number input controls
        function adjustNumber(inputId, delta) {
            const input = document.getElementById(inputId);
            let value = parseInt(input.value) || 0;
            value += delta;

            // Apply min/max constraints
            if (input.hasAttribute('min')) {
                value = Math.max(value, parseInt(input.getAttribute('min')));
            }
            if (input.hasAttribute('max')) {
                value = Math.min(value, parseInt(input.getAttribute('max')));
            }

            input.value = value;

            // Trigger onchange event if exists
            if (inputId === 'playerCount') {
                updatePlayersList();
            }
        }

        function adjustScore(playerIndex, delta) {
            const input = document.getElementById(`score-${playerIndex}`);
            let value = parseInt(input.value) || 0;
            value += delta;
            input.value = value;
        }

        // Game logic
        function startGame() {
            const playerCount = parseInt(document.getElementById('playerCount').value);
            const imposterCount = parseInt(document.getElementById('imposterCount').value);
            const t = translations[currentLanguage];
            
            if (imposterCount >= playerCount) {
                alert(t.impostersLessThanPlayers);
                return;
            }
            
            // Update player names
            for (let i = 0; i < playerCount; i++) {
                if (!gameState.playerNames[i]) {
                    gameState.playerNames[i] = `Player ${i + 1}`;
                }
            }
            
            gameState.players = playerCount;
            gameState.imposters = imposterCount;
            
            // Initialize player scores if starting fresh
            if (gameState.roundNumber === 1) {
                gameState.playerScores = [];
                // Hide score section for new games
                document.getElementById('scoreSection').style.display = 'none';
            }
            
            // Show custom word dialog before starting the game
            showCustomWordDialogForStart();
        }

        function updateGameDisplay() {
            const t = translations[currentLanguage];
            
            document.getElementById('currentPlayerName').textContent = gameState.playerNames[gameState.currentPlayer - 1];
            document.getElementById('currentPlayerNum').textContent = gameState.currentPlayer;
            document.getElementById('totalPlayers').textContent = gameState.players;
            
            const wordCard = document.getElementById('wordCard');
            const wordMain = document.getElementById('wordMain');
            const wordHint = document.getElementById('wordHint');
            const revealBtn = document.getElementById('revealBtn');
            const gameNavigation = document.getElementById('gameNavigation');
            
            wordCard.className = 'word-card';
            wordMain.textContent = gameState.playerNames[gameState.currentPlayer - 1];
            wordMain.classList.remove('imposter-red');
            wordHint.textContent = t.yourRole;
            revealBtn.textContent = t.tapToSeeRole;
            revealBtn.style.display = 'block';
            gameNavigation.style.display = 'none';
            gameState.wordRevealed = false;
        }

        // Reveal word logic (imposter text red, no box color change)
        function revealWord() {
            if (gameState.wordRevealed) return;
            
            const t = translations[currentLanguage];
            const currentRole = gameState.playerRoles[gameState.currentPlayer - 1];
            const wordCard = document.getElementById('wordCard');
            const wordMain = document.getElementById('wordMain');
            const wordHint = document.getElementById('wordHint');
            const revealBtn = document.getElementById('revealBtn');
            const gameNavigation = document.getElementById('gameNavigation');
            
            // Remove imposter-card class if present
            wordCard.className = 'word-card';

            if (currentRole.isImposter) {
                // Only text turns red, not the box
                wordMain.textContent = t.youAreImposter;
                wordMain.classList.add('imposter-red');
                // Show the main word's hint to the imposter in current language
                const hintText = currentLanguage === 'ku' ? gameState.mainWordHint.ku : gameState.mainWordHint.en;
                wordHint.textContent = `${t.hint} ${hintText}`;
            } else {
                wordMain.textContent = currentLanguage === 'ku' ? currentRole.word.word.ku : currentRole.word.word.en;
                wordMain.classList.remove('imposter-red');
                wordHint.textContent = t.noHints;
            }
            
            revealBtn.style.display = 'none';
            gameNavigation.style.display = 'block';
            gameState.wordRevealed = true;
            
            // Update next button text for last player
            const nextBtn = document.getElementById('nextBtn');
            if (gameState.currentPlayer === gameState.players) {
                nextBtn.textContent = t.startDiscussion;
            } else {
                nextBtn.textContent = t.nextPlayer;
            }
        }

        function nextPlayer() {
            const t = translations[currentLanguage];
            
            if (!gameState.wordRevealed) {
                alert(t.revealRoleFirst);
                return;
            }
            
            if (gameState.currentPlayer < gameState.players) {
                gameState.currentPlayer++;
                updateGameDisplay();
            } else {
                // All players have seen their roles
                startDiscussion();
            }
        }

        function startDiscussion() {
            const t = translations[currentLanguage];
            const wordCard = document.getElementById('wordCard');
            const wordMain = document.getElementById('wordMain');
            const wordHint = document.getElementById('wordHint');
            const nextBtn = document.getElementById('nextBtn');
            const gameNavigation = document.getElementById('gameNavigation');
            
            wordCard.className = 'word-card';
            wordMain.textContent = t.discussionTime;
            wordHint.textContent = t.findImposters;
            
            // Hide game navigation and show score section
            gameNavigation.style.display = 'none';
            showScoreInput();
        }

        function showScoreInput() {
            const t = translations[currentLanguage];
            document.getElementById('scoreSection').style.display = 'block';
            
            // Update score section title
            const scoreSectionTitle = document.querySelector('#scoreSection h3');
            if (scoreSectionTitle) scoreSectionTitle.textContent = t.enterScores;
            
            // Update score section buttons
            const scoreButtons = document.querySelectorAll('#scoreSection .btn');
            if (scoreButtons[0]) scoreButtons[0].textContent = t.nextRound;
            if (scoreButtons[1]) scoreButtons[1].textContent = t.endGame;
            
            const container = document.getElementById('scoreInputs');
            container.innerHTML = `<h4 style="text-align: center; margin-bottom: 15px;">${t.round} ${gameState.roundNumber}</h4>`;
            
            for (let i = 0; i < gameState.players; i++) {
                const totalScore = gameState.playerScores[i] ? gameState.playerScores[i].reduce((a, b) => a + b, 0) : 0;
                const scoreItem = document.createElement('div');
                scoreItem.className = 'score-item';
                scoreItem.innerHTML = `
                    <div style="flex: 1;">
                        <strong>${gameState.playerNames[i]}</strong><br>
                        <small>${t.total} ${totalScore} ${t.points}</small>
                    </div>
                    <div class="number-input-container">
                        <button class="number-btn decrease" onclick="adjustScore(${i}, -1)">-</button>
                        <input type="number" class="number-input score-input" value="0" id="score-${i}" placeholder="${t.roundScore}">
                        <button class="number-btn increase" onclick="adjustScore(${i}, 1)">+</button>
                                       </div>
                `;
                container.appendChild(scoreItem);
            }
        }

        function nextRound() {
            // Save scores for this round
            const roundScores = [];
            for (let i = 0; i < gameState.players; i++) {
                const scoreInput = document.getElementById(`score-${i}`);
                const score = parseInt(scoreInput.value) || 0;
                roundScores.push(score);
                
                // Initialize player scores array if needed
                if (!gameState.playerScores[i]) {
                    gameState.playerScores[i] = [];
                }
                gameState.playerScores[i].push(score);
            }
            
            // Don't save to history here, only when ending game
            
            // Increment round number
            gameState.roundNumber++;
            
            // Show custom word dialog for next round
            showCustomWordDialog();
        }

        function showCustomWordDialog() {
            const t = translations[currentLanguage];
            showScreen('customWordDialog');
            
            // Update dialog content
            const dialogTitle = document.querySelector('#customWordDialog h3');
            if (dialogTitle) dialogTitle.textContent = `${t.round} ${gameState.roundNumber} - ${t.customWordTitle || 'Choose Word'}`;
        }

        function showCustomWordDialogForStart() {
            const t = translations[currentLanguage];
            showScreen('customWordDialog');
            
            // Update dialog content for first round
            const dialogTitle = document.querySelector('#customWordDialog h3');
            if (dialogTitle) dialogTitle.textContent = `${t.round} ${gameState.roundNumber} - ${t.customWordTitle || 'Choose Word'}`;
        }

        function useRandomWordNextRound() {
            // Reset for next round
            gameState.currentPlayer = 1;
            gameState.wordRevealed = false;
            document.getElementById('scoreSection').style.display = 'none';
            
            // Clear dialog inputs
            document.getElementById('dialogCustomWord').value = '';
            document.getElementById('dialogCustomHint').value = '';
            
            // Start new game with random words
            startGameWithWords(null, null);
        }

        function useCustomWordNextRound() {
            const customWord = document.getElementById('dialogCustomWord').value.trim();
            const customHint = document.getElementById('dialogCustomHint').value.trim();
            const t = translations[currentLanguage];
            
            if (!customWord || !customHint) {
                alert(t.fillAllFields || 'Please fill all fields!');
                return;
            }
            
            // Reset for next round
            gameState.currentPlayer = 1;
            gameState.wordRevealed = false;
            document.getElementById('scoreSection').style.display = 'none';
            
            // Start new game with custom words
            startGameWithWords(customWord, customHint);
        }

        function startGameWithWords(customWord, customHint) {
            gameState.currentPlayer = 1;
            gameState.wordRevealed = false;
            
            // Select words (custom or random)
            let mainWord, imposterWord;
            
            if (customWord && customHint) {
                // Use custom word for regular players
                mainWord = {
                    word: { en: customWord, ku: customWord },
                    hint: { en: customHint, ku: customHint }
                };
                // Random word for imposters
                imposterWord = wordDatabase[Math.floor(Math.random() * wordDatabase.length)];
            } else {
                // Use random words
                mainWord = wordDatabase[Math.floor(Math.random() * wordDatabase.length)];
                do {
                    imposterWord = wordDatabase[Math.floor(Math.random() * wordDatabase.length)];
                } while (imposterWord === mainWord);
            }
            
            // Store main word hint for imposters
            gameState.mainWordHint = mainWord.hint;

            // Assign roles
            gameState.playerRoles = [];
            const imposterPositions = [];
            
            while (imposterPositions.length < gameState.imposters) {
                const pos = Math.floor(Math.random() * gameState.players);
                if (!imposterPositions.includes(pos)) {
                    imposterPositions.push(pos);
                }
            }
            
            for (let i = 0; i < gameState.players; i++) {
                gameState.playerRoles.push({
                    isImposter: imposterPositions.includes(i),
                    word: imposterPositions.includes(i) ? imposterWord : mainWord
                });
            }
            
            updateGameDisplay();
            showScreen('gameScreen');
        }

        function endGame() {
            // Save scores for the current round first
            const roundScores = [];
            for (let i = 0; i < gameState.players; i++) {
                const scoreInput = document.getElementById(`score-${i}`);
                const score = parseInt(scoreInput.value) || 0;
                roundScores.push(score);

                // Initialize player scores array if needed
                if (!gameState.playerScores[i]) {
                    gameState.playerScores[i] = [];
                }
                gameState.playerScores[i].push(score);
            }

            // Save complete game to history
            saveGameToHistory(roundScores);

            // Show results screen before resetting
            showResultsScreen();

            // Reset game state for next game after returning home
            gameState = {
                players: 5,
                imposters: 1,
                currentPlayer: 1,
                playerNames: [],
                playerRoles: [],
                wordRevealed: false,
                playerScores: [],
                roundNumber: 1
            };
        }

        // Game History
        function saveGameToHistory(scores = []) {
            // Only save when ending game, not after each round
            if (scores.length === 0) return;
            
            const history = JSON.parse(localStorage.getItem('kurdishImposterHistory' ) || '[]');
            
            // Calculate total scores for each player across all rounds
            const totalScores = [];
            for (let i = 0; i < gameState.players; i++) {
                const playerTotalScore = gameState.playerScores[i] ? gameState.playerScores[i].reduce((a, b) => a + b, 0) : 0;
                totalScores.push(playerTotalScore);
            }
            
            const gameRecord = {
                date: new Date().toLocaleDateString(),
                time: new Date().toLocaleTimeString(),
                players: [...gameState.playerNames],
                scores: [...totalScores],
                rounds: gameState.roundNumber, // Current round number is correct
                imposters: gameState.imposters
            };
            
            history.unshift(gameRecord);
            
            // Keep only last 20 games
            if (history.length > 20) {
                history.splice(20);
            }
            
            localStorage.setItem('kurdishImposterHistory', JSON.stringify(history));
        }

        function loadGameHistory() {
            const t = translations[currentLanguage];
            const history = JSON.parse(localStorage.getItem('kurdishImposterHistory') || '[]');
            const container = document.getElementById('historyList');
            
            if (history.length === 0) {
                container.innerHTML = `<p>${t.noGamesYet}</p>`;
                return;
            }
            
            container.innerHTML = history.map(game => {
                let playersWithScores = '';
                if (game.scores && game.scores.length > 0) {
                    playersWithScores = game.players.map((player, index) => 
                        `${player}: ${game.scores[index] || 0} ${t.points}`
                    ).join(', ');
                } else {
                    playersWithScores = game.players.join(', ');
                }
                
                const roundsText = game.rounds > 1 ? `${game.rounds} ${t.rounds}` : `1 ${t.round_single}`;
                
                return `
                    <div class="history-item">
                        <div class="history-date">${game.date} - ${game.time}</div>
                        <div><strong>${t.gameSession}</strong> ${roundsText}</div>
                        <div><strong>${t.finalScores}</strong> ${playersWithScores}</div>
                        <div><strong>${t.impostersPerRound}</strong> ${game.imposters}</div>
                    </div>
                `;
            }).join('');
        }

        // Word Editor
        function toggleWordEditor() {
            const editor = document.getElementById('wordEditor');
            const isVisible = editor.style.display !== 'none';
            
            if (isVisible) {
                editor.style.display = 'none';
            } else {
                editor.style.display = 'block';
                updateWordList();
            }
        }

        function updateWordList() {
            const t = translations[currentLanguage];
            const container = document.getElementById('wordList');
            container.innerHTML = wordDatabase.map((word, index) => `
                <div class="word-item">
                    <div>
                        <strong>${word.word.en} / ${word.word.ku}</strong><br>
                        <small>${word.hint.en} / ${word.hint.ku}</small>
                    </div>
                    <button class="delete-btn" onclick="deleteWord(${index})">${t.delete}</button>
                </div>
            `).join('');
        }

        function addNewWord() {
            const t = translations[currentLanguage];
            const wordEn = document.getElementById('newWordEn').value.trim();
            const wordKu = document.getElementById('newWordKu').value.trim();
            const hintEn = document.getElementById('newHintEn').value.trim();
            const hintKu = document.getElementById('newHintKu').value.trim();
            
            if (!wordEn || !wordKu || !hintEn || !hintKu) {
                alert(t.fillAllFields);
                return;
            }
            
            wordDatabase.push({
                word: { en: wordEn, ku: wordKu },
                hint: { en: hintEn, ku: hintKu }
            });
            
            // Clear inputs
            document.getElementById('newWordEn').value = '';
            document.getElementById('newWordKu').value = '';
            document.getElementById('newHintEn').value = '';
            document.getElementById('newHintKu').value = '';
            
            updateWordList();
        }

        function deleteWord(index) {
            const t = translations[currentLanguage];
            
            if (wordDatabase.length <= 5) {
                alert(t.cannotDelete);
                return;
            }
            
            if (confirm(t.deleteWord)) {
                wordDatabase.splice(index, 1);
                updateWordList();
            }
        }

        function openMoreGames() {
            window.open('https://github.com/Didar122/', '_blank', 'noopener,noreferrer');
        }

        function clearAllData() {
            showScreen('confirmDialog');
        }

        function confirmClearData() {
            // Clear localStorage
            localStorage.removeItem('kurdishImposterHistory');
            localStorage.removeItem('kurdishImposterTheme');
            
            // Reset game state
            gameState = {
                players: 5,
                imposters: 1,
                currentPlayer: 1,
                playerNames: [],
                playerRoles: [],
                wordRevealed: false,
                playerScores: [],
                roundNumber: 1
            };
            
            // Reset theme to default
            changeTheme('modern');
            
            showSettings();
            
            // Show success message in a custom way
            setTimeout(() => {
                const t = translations[currentLanguage];
                const container = document.querySelector('#settingsScreen .container');
                const successMsg = document.createElement('div');
                successMsg.style.cssText = 'background: rgba(67, 233, 123, 0.2); color: white; padding: 15px; border-radius: 10px; margin: 15px 0; text-align: center;';
                successMsg.textContent = t.allDataCleared;
                container.insertBefore(successMsg, container.firstChild.nextSibling);
                
                setTimeout(() => {
                    successMsg.remove();
                }, 3000);
            }, 100);
        }

        function cancelClearData() {
            showSettings();
        }

        // Check if splash image exists
        function checkSplashImage() {
            const splashLogo = document.getElementById('splashLogo');
            const testImg = new Image();
            
            testImg.onload = function() {
                // Image exists, hide emoji
                splashLogo.textContent = '';
            };
            
            testImg.onerror = function() {
                // Image doesn't exist, show emoji and remove background
                splashLogo.classList.add('no-image');
                splashLogo.textContent = '🎭';
            };
            
            testImg.src = 'splash.png';
        }

        // Button sound effects
        function playButtonSound() {
            // Create a simple click sound using Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        // Tap Animation Effects
        function createRippleEffect(e) {
            const button = e.currentTarget;
            const rect = button.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            const ripple = document.createElement('span');
            ripple.className = 'tap-ripple';
            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = x + 'px';
            ripple.style.top = y + 'px';
            
            button.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }

        function addTapBounce(element) {
            element.classList.add('tap-bounce');
            setTimeout(() => {
                element.classList.remove('tap-bounce');
            }, 300);
        }

        // Add click sound and animations to all buttons
        function addButtonSounds() {
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('btn') || e.target.classList.contains('back-btn') || e.target.classList.contains('theme-btn')) {
                    try {
                        playButtonSound();
                    } catch (error) {
                        // Silently fail if audio context is not available
                    }
                    
                    // Add tap effects
                    if (e.target.classList.contains('btn')) {
                        e.target.classList.add('tap-effect');
                        createRippleEffect(e);
                        addTapBounce(e.target);
                    } else {
                        addTapBounce(e.target);
                    }
                }
                
                // Add tap effects to word cards and other interactive elements
                if (e.target.classList.contains('word-card') || e.target.closest('.word-card')) {
                    const wordCard = e.target.classList.contains('word-card') ? e.target : e.target.closest('.word-card');
                    addTapBounce(wordCard);
                }
            });
        }

        // Initialize
        function initApp() {
            // Load saved theme
            const savedTheme = localStorage.getItem('kurdishImposterTheme');
            if (savedTheme) {
                changeTheme(savedTheme);
            }
            
            // Load saved language
            const savedLanguage = localStorage.getItem('kurdishImposterLanguage');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                document.getElementById('languageSelect').value = savedLanguage;
                updateLanguageDisplay();
            }
            
            checkSplashImage();
            updatePlayersList();
            addButtonSounds();
            
            // Show splash screen for 3 seconds
            setTimeout(() => {
                showMainMenu();
            }, 3000);
        }

                document.addEventListener('DOMContentLoaded', initApp);
                </script>

        <!-- News ticker script: supports Kurdish RTL/LTR and easy edits -->
        <script>
        (function(){
            // Default messages: edit window.tickerMessages or call updateTicker([...]) from other code
            window.tickerMessages = window.tickerMessages || [
                'بەخێربێن بۆ یاری ئیمپۆستەری کوردی',
                'لێرەوە ئاگادار ئەبن لەهەرزانیاریەکی تازە لەسەر یاریەکە ، یاخود هەر نوێکردنەوەیەکی تازە هەبێت',
                'دەتوانیت پەنجە ڕاگریت لەسەر هەواڵەکە و ڕایگریت تا باشتر بتوانیت بیخوێنیتەوە',
                'داواکاری و پێشنیارەکانت دەتوانیت بنێریت بۆ ئەم ئیمەیڵی دواتر',
                'didar.baxtear@gmail.com'
            ];

            function containsArabicChars(s){
                 return /[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/.test(s);
            }

            function createTicker(){
                const ticker = document.querySelector('.news-ticker');
                if(!ticker) return;
                const msgs = (window.tickerMessages||[]).filter(Boolean);
                const existingTrack = ticker.querySelector('.ticker-track');
                let track = existingTrack;
                if(!track){ track = document.createElement('div'); track.className = 'ticker-track'; ticker.appendChild(track); }
                track.innerHTML = '';

                if(msgs.length===0){ ticker.style.display='none'; return; } 
                // start hidden; we'll show when the main menu (home) is active
                ticker.style.display = 'none';

                const single = document.createElement('div');
                single.className = 'ticker-single';
                track.appendChild(single);

                // Pause on touch/hover via JS flags
                let isPaused = false;
                ticker.addEventListener('touchstart', ()=>{ isPaused = true; }, {passive:true});
                ticker.addEventListener('touchend', ()=>{ isPaused = false; }, {passive:true});
                ticker.addEventListener('mouseenter', ()=>{ isPaused = true; });
                ticker.addEventListener('mouseleave', ()=>{ isPaused = false; });

                // Helper: only show/run ticker when #mainMenu is active (home page)
                function isHomeActive(){ const el = document.getElementById('mainMenu'); return el && el.classList.contains('active'); }

                // Animation loop using requestAnimationFrame so we can pause/resume cleanly
                const speed = 90; // px per second
                let rafId = null;
                let stopped = false;

                async function playOnce(msg){
                    return new Promise((resolve)=>{
                        single.textContent = msg;
                        single.dir = containsArabicChars(msg) ? 'rtl' : 'ltr';
                        // ensure it's positioned and measurable
                        single.style.transform = 'translateX(0px)';
                        single.style.left = '0px';
                        // wait a frame to render
                        requestAnimationFrame(()=>{
                            const trackRect = track.getBoundingClientRect();
                            const itemRect = single.getBoundingClientRect();
                            // LEFT -> RIGHT motion: start offscreen to the left, end offscreen to the right
                            const startX = -itemRect.width;
                            const endX = trackRect.width;
                            const distance = endX - startX; // positive
                            const duration = Math.max(3, distance / speed); // seconds

                            let startTime = null;
                            let pauseStart = null;
                            let pausedTime = 0;

                            function step(ts){
                                if(stopped) return resolve();
                                if(!startTime) startTime = ts;
                                if(isPaused){
                                    if(pauseStart===null) pauseStart = ts;
                                    rafId = requestAnimationFrame(step);
                                    return;
                                }
                                if(pauseStart!==null){
                                    pausedTime += ts - pauseStart;
                                    startTime += pausedTime;
                                    pauseStart = null;
                                    pausedTime = 0;
                                }

                                const elapsed = (ts - startTime) / 1000; // seconds
                                const t = Math.min(1, elapsed / duration);
                                const x = startX + (endX - startX) * t;
                                single.style.transform = `translateX(${x}px)`;
                                if(t < 1){
                                    rafId = requestAnimationFrame(step);
                                } else {
                                    resolve();
                                }
                            }

                            // init offscreen to the left
                            single.style.transform = `translateX(${startX}px)`;
                            rafId = requestAnimationFrame(step);
                        });
                    });
                }

                // sequential loop
                (async function loop(){
                    let i = 0;
                    while(!stopped){
                        const msg = msgs[i % msgs.length];
                        // wait until home page is active
                        while(!stopped && !isHomeActive()){
                            ticker.style.display = 'none';
                            await new Promise(r=>setTimeout(r, 200));
                        }
                        if(stopped) break;
                        ticker.style.display = 'flex';
                        await playOnce(msg);
                        // small pause between messages
                        let waited = 0;
                        const gap = 450;
                        while(waited < gap){ if(stopped) break; await new Promise(r=>setTimeout(r, 50)); waited += 50; }
                        i++;
                    }
                })();

                // expose a way to stop if needed
                return ()=>{ stopped = true; if(rafId) cancelAnimationFrame(rafId); };
            }

            // Manage ticker lifecycle: recreate on DOMContentLoaded and allow updateTicker to restart
            let stopTicker = null;
            function initAndStart(){ if(stopTicker) stopTicker(); stopTicker = createTicker(); }
            document.addEventListener('DOMContentLoaded', initAndStart);
            window.updateTicker = function(msgs){ window.tickerMessages = msgs; initAndStart(); };
            })();
        </script>


<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9890460797a8f74a',t:'MTc1OTUzNDcxMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
<!-- Service Worker registration for offline support (PWA) -->
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js', { scope: '/' })
                .then(reg => {
                    console.log('ServiceWorker registered with scope:', reg.scope);
                }).catch(err => {
                    console.warn('ServiceWorker registration failed:', err);
                });
        });
    } else {
        console.log('Service workers not supported in this browser.');
    }
</script>
</body>
</html>

